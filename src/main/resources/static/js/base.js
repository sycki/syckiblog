Date.prototype.Format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)(new RegExp("("+c+")")).test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a};
function preview(a){article_local_cache(a);window.open("/dashboard/preview")}
function article_local_cache(){var a=(new Date).Format("yyyy-MM-dd HH:mm:ss"),b=document.getElementById("article-id"),c=document.getElementById("article-editor"),d=document.getElementById("article-title"),e=document.getElementById("article-en_name"),f=document.getElementById("article-tags");localStorage.setItem("article_id",b.value);localStorage.setItem("article_text",c.value);localStorage.setItem("article_title",d.value);localStorage.setItem("article_en_name",e.value);localStorage.setItem("article_tags",
f.value);localStorage.setItem("create_time",a);document.getElementById("save-time").innerHTML="\u4e0a\u6b21\u4fdd\u5b58\uff1a"+a}
function get_article(a){var b=document.getElementById("article-id"),c=document.getElementById("article-editor"),d=document.getElementById("article-title"),e=document.getElementById("article-en_name"),f=document.getElementById("article-tags"),g=new XMLHttpRequest;g.onreadystatechange=function(){if(4==g.readyState&&200==g.status){var a=g.responseText;a=JSON&&JSON.parse(a)||eval("("+a+")");b.value=a.id;c.value=a.content;d.value=a.title;e.value=a.en_name;f.value=a.tags;check_article_local_cache()}};g.open("GET",
"/api/articles/"+a,!0);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.setRequestHeader("X-Requested-By","sycki");g.send()}
function check_article_local_cache(){var a=localStorage.getItem("article_id"),b=localStorage.getItem("article_title"),c=localStorage.getItem("create_time");null!==a&&a==document.getElementById("article-id").value&&1==confirm("\u672c\u5730\u7f13\u5b58\u4e86\u4e0a\u6b21\u672a\u5199\u5b8c\u7684\u6587\u7ae0\uff01\n\u6587\u7ae0\uff1a["+b+"]\n\u65f6\u95f4\uff1a["+c+"]\n\u662f\u5426\u6062\u590d\u5185\u5bb9\uff1f")&&article_local_load()}
function write_submit(){var a=document.getElementById("article-id"),b=document.getElementById("article-editor"),c=document.getElementById("article-title"),d=document.getElementById("article-en_name"),e=document.getElementById("article-tags");c="title="+c.value;c+="&id="+a.value;c+="&content="+encodeURIComponent(b.value);c+="&en_name="+d.value;c+="&tags="+e.value;var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState&&200==f.status){var a=f.responseText;document.getElementById("message").innerHTML=
a;"\u6587\u7ae0\u5df2\u63d0\u4ea4\uff01"===a&&localStorage.clear()}};f.open("POST","/dashboard/writer",!0);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.send(c)}
function article_local_load(){var a=document.getElementById("article-id"),b=document.getElementById("article-editor"),c=document.getElementById("article-title"),d=document.getElementById("article-en_name"),e=document.getElementById("article-tags");a.value=localStorage.getItem("article_id");b.value=localStorage.getItem("article_text");c.value=localStorage.getItem("article_title");d.value=localStorage.getItem("article_en_name");e.value=localStorage.getItem("article_tags")}
function getElementsByClassName(a){for(var b=[],c=document.getElementsByTagName("*"),d=0;d<c.length;d++)c[d].className==a&&(b[b.length]=c[d]);return b}
function parser_article(a){a=document.getElementById(a);if(null!=a){var b=a.innerHTML.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");b=marked(b);b=b.replace(/(<h[1-6]{1}.+>)(.+)(<\/h[1-6]{1}>)/g,"<a class='anchor-ids' id='$2'>$1$2$3</a>");a.innerHTML=b;a=document.getElementById("sections");if(null!=a){b=getElementsByClassName("anchor-ids");for(var c=a.innerHTML,d=0,e=0;e<b.length;e++){var f=b[e].textContent,g=parseInt(b[e].innerHTML.substring(2,3));g>d?(c+="<ul><a href='#"+b[e].id+
"'><li>"+f+"</li></a>",d=g):g==d?(c+="<a href='#"+b[e].id+"'><li>"+f+"</li></a>",d=g):g<d&&(c+="</ul><a href='#"+b[e].id+"'><li>"+f+"</li></a>",d=g)}a.innerHTML=c+"</ul>"}}}
function login_data_check(){var a=document.getElementById("input-user"),b=document.getElementById("input-pass"),c=document.getElementById("input-code"),d=!0;/^\w{5,20}$/.test(a.value)?a.style.borderColor="#afa":(a.style.borderColor="#faa",d=!1);/^\w{5,20}$/.test(b.value)?b.style.borderColor="#afa":(b.style.borderColor="#faa",d=!1);/^\w{4,5}$/.test(c.value)?c.style.borderColor="#afa":(c.style.borderColor="#faa",d=!1);return d}
function article_desc_thumb_up(a){var b=document.getElementById(a+"_thumb_up"),c=document.getElementById(a+"_thumb_up_value"),d=b.style.backgroundColor;core.onreadystatechange=function(){4==core.readyState&&200==core.status&&"success"==core.responseText&&("rgb(235, 243, 251)"==d||""==d?(b.style.backgroundColor="rgb(57, 150, 242)",c.innerHTML=parseInt(c.innerHTML)+1):(b.style.backgroundColor="rgb(235, 243, 251)",c.innerHTML=parseInt(c.innerHTML)-1))};"rgb(235, 243, 251)"==d||""==d?core.open("GET",
"/article/"+a+"/like/"+reshow(),!0):core.open("GET","/article/"+a+"/unlike/"+reshow(),!0);core.send()}function article_desc_thumb_down(a){var b=document.getElementById(a+"_thumb_down");a=document.getElementById(a+"_thumb_up");var c=b.style.backgroundColor;"rgb(235, 243, 251)"==c||""==c?(b.style.backgroundColor="#3996f2",a.style.backgroundColor="#ebf3fb"):b.style.backgroundColor="#ebf3fb"}
function bin2hex(a){var b,c="";a+="";var d=0;for(b=a.length;d<b;d++){var e=a.charCodeAt(d).toString(16);c+=2>e.length?"0"+e:e}return c}
function reshow(){var a=document.createElement("canvas"),b=a.getContext("2d");b.textBaseline="top";b.font="14px 'Arial'";b.textBaseline="tencent";b.fillStyle="#f60";b.fillRect(125,1,62,20);b.fillStyle="#069";b.fillText("blog.giepin.com",2,15);b.fillStyle="rgba(102, 104, 0, 0.7)";b.fillText("blog.giepin.com",4,17);a=a.toDataURL().replace("data:image/png;base64,","");a=atob(a);return bin2hex(a.slice(-16,-12))}var core=new XMLHttpRequest,reshow_context=reshow();
function init(){window.article_id&&null!=window.article_id?(core.open("POST","/article/viewer",!0),core.setRequestHeader("Content-type","application/x-www-form-urlencoded"),core.send("name="+reshow_context+"&articleId="+article_id)):(core.open("POST","/reshow",!0),core.setRequestHeader("Content-type","application/x-www-form-urlencoded"),core.send("name="+reshow_context+"&url="+location.pathname))}window.onload=function(){parser_article("article");setTimeout("init()",5E4)};